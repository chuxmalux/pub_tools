
# EXAM RT {



# J1 


# J2 



# T1 {
=========================================================================================================
``` 1. Connection/ Exploit ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 2. Survey ``` {
---------------------------------------------------------------------------------------------------------

# netstat 

# ps 

# misc

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Malware 
search -f *each-process* (verify if duplicates)

# ESP

# Logs 

--------------------------------------------------------------------------------------------------------- }

``` 3. Actions ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 4. LOGS/ EXITS ``` {
---------------------------------------------------------------------------------------------------------

++++ always correlate timestamps! ++++
---- ALWAYS exit extra meterpreter sessions b4 cleaning, and CHECK for exits ---- 

# nix common logs {
egrep -r '' /var/log 

/var/log/auth.log
	# ^ clean IP and systemd session creation
	/var/log/secure
/var/log/syslog 
	# ^ needs more than IP to clean
/var/log/kern.log
	# typically logs <IP> and <systemd> slices. --- use timestamps, systemd includes [1] and [RHN] 'reached targets'
/var/log/audit/audit.log 
/var/log/smb/log.smbd ***
	e.g. '16:09:26|172.17.10.80' /var/log/samba/log.smbd
	grep "<EXPLOIT TIME>|<IP>"
}

egrep -r '<IPs>' /var/log # FINAL CHECK !




# FINAL PRESENCE CHECK 
find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -<TIME> -type f -print0 | xargs -0 ls -latr 

--------------------------------------------------------------------------------------------------------- }
========================================================================================================= }



# T2 {
=========================================================================================================
``` 1. Connection/ Exploit ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 2. Survey ``` {
---------------------------------------------------------------------------------------------------------

# netstat 

# ps 

# misc

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Malware 
search -f *each-process* (verify if duplicates)

# ESP

# Logs 

--------------------------------------------------------------------------------------------------------- }

``` 3. Actions ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 4. LOGS/ EXITS ``` {
---------------------------------------------------------------------------------------------------------

++++ always correlate timestamps! ++++
---- ALWAYS exit extra meterpreter sessions b4 cleaning, and CHECK for exits ---- 

# win common logs {
run multicommand -cl 'wevtutil qe SYSTEM /c:15 /rd:true /f:text'
run multicommand -cl 'wevtutil qe SECURITY /c:15 /rd:true /f:text' 
run multicommand -cl 'wevtutil qe APPLICATION /c:15 /rd:true /f:text'
run multicommand -cl 'wevtutil qe "Windows Powershell" /c:15 /rd:true /f:text'
	
# query related SYSTEM/SEC/POWERSHELL IDs 
run multicommand -cl 'wevtutil qe SYSTEM "/q:*[System [(EventID=7009)]]" /rd:true /f:text' 


}




--------------------------------------------------------------------------------------------------------- }
========================================================================================================= }



# T3 {
=========================================================================================================
``` 1. Connection/ Exploit ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 2. Survey ``` {
---------------------------------------------------------------------------------------------------------

# netstat 

# ps 

# misc

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Malware 
search -f *each-process* (verify if duplicates)

# ESP

# Logs 

--------------------------------------------------------------------------------------------------------- }

``` 3. Actions ``` {
---------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------- }

``` 4. LOGS/ EXITS ``` {
---------------------------------------------------------------------------------------------------------

++++ always correlate timestamps! ++++
---- ALWAYS exit extra meterpreter sessions b4 cleaning, and CHECK for exits ---- 

# nix common logs {
egrep -r '' /var/log 

/var/log/auth.log
	# ^ clean IP and systemd session creation
	/var/log/secure
/var/log/syslog 
	# ^ needs more than IP to clean
/var/log/kern.log
	# typically logs <IP> and <systemd> slices. --- use timestamps, systemd includes [1] and [RHN] 'reached targets'
/var/log/audit/audit.log 
/var/log/smb/log.smbd ***
	e.g. '16:09:26|172.17.10.80' /var/log/samba/log.smbd
	grep "<EXPLOIT TIME>|<IP>"
}

egrep -r '<IPs>' /var/log # FINAL CHECK !



# FINAL PRESENCE CHECK 
find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -<TIME> -type f -print0 | xargs -0 ls -latr 

--------------------------------------------------------------------------------------------------------- }
========================================================================================================= }


}



``` REMEMBER: 
- TIMESTAMP: all exploit & connection attempts!
	- date -u
- exit meterpreter sessions before cleaning!!! - espec linux 
- survey immediately post exploit
- before any conn/exploit: are FW rules + PortFWD set?

- 60+ mins MINIMUM for log clean

``` 


# IPs REF 2
